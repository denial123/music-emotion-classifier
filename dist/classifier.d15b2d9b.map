{"version":3,"sources":["scripts\\ShapeData.ts","scripts\\classifier.ts"],"names":[],"mappings":"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","file":"classifier.d15b2d9b.map","sourceRoot":"..","sourcesContent":["// Gathers all functions used to make the dataset ok for tensors\r\n\r\nexport class ShapeData {\r\n\r\n    featuresList = [\r\n        \"tempo\",\r\n        \"total_beats\",\r\n        \"average_beats\",\r\n        \"chroma_stft_mean\",\r\n        \"chroma_stft_std\",\r\n        \"chroma_stft_var\",\r\n        \"chroma_cq_mean\",\r\n        \"chroma_cq_std\",\r\n        \"chroma_cq_var\",\r\n        \"chroma_cens_mean\",\r\n        \"chroma_cens_std\",\r\n        \"chroma_cens_var\",\r\n        \"melspectrogram_mean\",\r\n        \"melspectrogram_std\",\r\n        \"melspectrogram_var\",\r\n        \"mfcc_mean\",\r\n        \"mfcc_std\",\r\n        \"mfcc_var\",\r\n        \"mfcc_delta_mean\",\r\n        \"mfcc_delta_std\",\r\n        \"mfcc_delta_var\",\r\n        \"rmse_mean\",\r\n        \"rmse_std\",\r\n        \"rmse_var\",\r\n        \"cent_mean\",\r\n        \"cent_std\",\r\n        \"cent_var\",\r\n        \"spec_bw_mean\",\r\n        \"spec_bw_std\",\r\n        \"spec_bw_var\",\r\n        \"contrast_mean\",\r\n        \"contrast_std\",\r\n        \"contrast_var\",\r\n        \"rolloff_mean\",\r\n        \"rolloff_std\",\r\n        \"rolloff_var\",\r\n        \"poly_mean\",\r\n        \"poly_std\",\r\n        \"poly_var\",\r\n        \"tonnetz_mean\",\r\n        \"tonnetz_std\",\r\n        \"tonnetz_var\",\r\n        \"zcr_mean\",\r\n        \"zcr_std\",\r\n        \"zcr_var\",\r\n        \"harm_mean\",\r\n        \"harm_std\",\r\n        \"harm_var\",\r\n        \"perc_mean\",\r\n        \"perc_std\",\r\n        \"perc_var\",\r\n        \"frame_mean\",\r\n        \"frame_std\",\r\n        \"frame_var\"\r\n    ]; // all sound features, inputs\r\n\r\n\r\n    makeDatasetForTensors(data: object): Array<Array<any>> {\r\n        let dataInputs = [];\r\n        let dataOutputs = [];\r\n        for (const singleSong in data) {\r\n            let newArray = this.convertObjectToArray(data[singleSong]);\r\n            const input = newArray.splice(4); // all the features\r\n            const output = newArray.splice(2, 1); // the label like \"relax\" or \"happy\"\r\n            dataInputs.push(input);\r\n            dataOutputs.push(output);\r\n        }\r\n        return [\r\n            dataInputs,\r\n            dataOutputs\r\n        ];\r\n    };\r\n\r\n    makeUnclassifiedSongsForTensors(songsToClassify: object) {\r\n        let enumFeatures = this.convertObjectToArray(songsToClassify);\r\n        let numberOfSongs = Object.keys(enumFeatures[0]).length;\r\n        let songNames = [];\r\n        let allFeatures = [];\r\n        for (let i=1; i<numberOfSongs+1; i++) {\r\n            let songName = \"\";\r\n            let singleSongFeatures = [];\r\n            for (let j=0; j<enumFeatures.length; j++) {\r\n                if (j === 0) {\r\n                    songName = enumFeatures[j][i];\r\n                } else {\r\n                    singleSongFeatures.push(enumFeatures[j][i]);\r\n                }\r\n            }\r\n            songNames.push(songName);\r\n            allFeatures.push(singleSongFeatures);\r\n        }\r\n\r\n        return [\r\n            songNames,\r\n            allFeatures\r\n        ];\r\n    }\r\n\r\n    convertObjectToArray(data: object): Array<Array<any>> {\r\n        // Converts the object to an iterable object\r\n        let newArray = [];\r\n        for(let [key, value] of Object.entries(data)) {\r\n            if (!Object.entries)\r\n                Object.entries = function( obj ){\r\n                    var ownProps = Object.keys( obj ),\r\n                        i = ownProps.length,\r\n                        resArray = new Array(i); // preallocate the Array\r\n                    while (i--)\r\n                        resArray[i] = [ownProps[i], obj[ownProps[i]]];\r\n                    if (i<ownProps.length-3) {\r\n                        return resArray;\r\n                    }\r\n                };\r\n            newArray.push(value); // add each feature to an array\r\n            // console.log(key, value); // \"first\", \"one\"\r\n        }\r\n        // Returns an array with\r\n        // [0] List of features\r\n        // [1] Label (\"relax\", \"calm\"...)\r\n        return newArray;\r\n    };\r\n\r\n    normalizeData(originalData: object, arrayLikeData: object): Array<Array<number>> {\r\n\r\n        // console.log(originalData);\r\n\r\n        let normalizedData = [];\r\n        // Normalize data to a 0-1 range\r\n\r\n        // We get the range for each feature\r\n        // It returns an object like that:\r\n        // 0: {\r\n        //     feature: \"tempo\",\r\n        //         min: 53.83300781,\r\n        //         max: 198.7680288\r\n        // }\r\n        // ...\r\n        let featuresRange = this.getMinMaxValues(originalData);\r\n        // console.log(featuresRange);\r\n\r\n        for (const song in arrayLikeData) {\r\n            let singleNormalizedData = [];\r\n            for (let i=0; i<arrayLikeData[song].length; i++) {\r\n                let norm = this.normalize(arrayLikeData[song][i], featuresRange[i].min, featuresRange[i].max);\r\n                singleNormalizedData.push(norm);\r\n            }\r\n            normalizedData.push(singleNormalizedData);\r\n        }\r\n        return normalizedData;\r\n\r\n\r\n    };\r\n\r\n    normalize(value: number, minValue: number, maxValue: number): number {\r\n        return (value-minValue)/(maxValue-minValue);\r\n    }\r\n\r\n    getMinMaxValues(data: object): object {\r\n\r\n        let featuresMinMax = []; // to store the min and max value used for normalizing the inputs\r\n\r\n        for (let i=0; i<this.featuresList.length; i++) {\r\n            let maxValue = 0;\r\n            let minValue = 0;\r\n            let counter = 0;\r\n\r\n            for (const song in data) {\r\n                let value = data[song][this.featuresList[i]];\r\n\r\n                if (counter === 0) {\r\n                    maxValue = value;\r\n                    minValue = value;\r\n                }\r\n                if (value > maxValue) {\r\n                    maxValue = value;\r\n                }\r\n                if (value < minValue) {\r\n                    minValue = value;\r\n                }\r\n                counter++;\r\n            }\r\n\r\n            featuresMinMax.push({\r\n                \"feature\": this.featuresList[i],\r\n                \"min\": minValue,\r\n                \"max\": maxValue\r\n            });\r\n        }\r\n\r\n        return featuresMinMax;\r\n\r\n    }\r\n\r\n\r\n    isIterable(obj) {\r\n        console.log(obj);\r\n        // checks for null and undefined\r\n        if (obj == null) {\r\n            return false;\r\n        }\r\n        return typeof obj[Symbol.iterator] === 'function';\r\n    }\r\n\r\n}","'use strict';\r\n\r\n// Import data\r\nimport * as dataset from \"../data/Emotion_data.json\";\r\nimport * as toClassify from \"../toClassify/Emotion_features.json\";\r\n\r\n// Import functions to convert data\r\nimport * as SD from \"./ShapeData\";\r\nconst ShapeData = new SD.ShapeData;\r\n\r\n\r\n// const Classifier = (p) => {\r\nlet data = {};\r\nlet songsToClassify = {};\r\nlet dataInputs = []; // The output of dataInputs[0] is dataOutputs[0]\r\nlet labelList = [\"sad\", \"happy\", \"relax\", \"angry\"];\r\nlet labels = []; // hot encoded values 0, 1, 2 or 3\r\nlet normalizedData = [];\r\n\r\nlet model;\r\n\r\nsetup();\r\n\r\nfunction setup(): void {\r\n\r\n    loadJSON(dataset.default) // We have to use .default to load the url correctly with parcel\r\n        .then((jsonDataset) => {\r\n            data = JSON.parse(jsonDataset);\r\n            // let test = isIterable(data);\r\n            // console.log(test);\r\n\r\n\r\n            // train(xs, ys).then( (result) => {\r\n            //     console.log(result);\r\n            // });\r\n\r\n            // console.log(xs.shape);\r\n            // console.log(xs);\r\n            // console.log(labels)\r\n            // makeInputs();\r\n            return loadJSON(toClassify.default);\r\n        })\r\n        .then((jsonSongs) => {\r\n            songsToClassify = JSON.parse(jsonSongs);\r\n            let toClassify = ShapeData.makeUnclassifiedSongsForTensors(songsToClassify);\r\n            let songNames = toClassify[0];\r\n            let songFeatures = toClassify[1];\r\n            console.log(songFeatures);\r\n\r\n            // ---|-- Building the model ------|-----\r\n            // ---v----------------------------v-----\r\n\r\n            let newData = ShapeData.makeDatasetForTensors(data);\r\n            dataInputs = newData[0];\r\n            let dataOutputs = newData[1]; // the outputs are \"relax\", \"calm\"...\r\n\r\n            for (let i=0; i<dataOutputs.length; i++) {\r\n                labels.push(labelList.indexOf(dataOutputs[i][0])); // in the label list we put the hot encoded values like 0, 1, 2 or 3\r\n            }\r\n\r\n            normalizedData = ShapeData.normalizeData(data, dataInputs);\r\n\r\n\r\n            let xs = tf.tensor2d(normalizedData);\r\n            let labelsTensor = tf.tensor1d(labels, \"int32\"); // makes a tensor with the labels\r\n            let ys = tf.oneHot(labelsTensor, labelList.length); // defines the outputs\r\n            labelsTensor.dispose(); // for memory management, as we don't need anymore, we use dispose()\r\n            // console.log(xs.shape);\r\n            // console.log(ys.shape);\r\n            // xs.print();\r\n            // ys.print();\r\n\r\n            model = tf.sequential();\r\n            let hiddenLayer = tf.layers.dense({\r\n                units: 16,\r\n                activation: \"sigmoid\",\r\n                inputDim: 54\r\n            });\r\n            let outputLayer = tf.layers.dense({\r\n                units: 4,\r\n                activation: \"softmax\"\r\n            });\r\n            model.add(hiddenLayer);\r\n            model.add(outputLayer);\r\n\r\n            // Create an optimizer\r\n            const learningRate = 0.2;\r\n            const myOptimizer = tf.train.sgd(learningRate);\r\n\r\n            model.compile({\r\n                optimizer: myOptimizer,\r\n                loss: \"categoricalCrossentropy\"\r\n            });\r\n\r\n        })\r\n        .catch((err) => console.log(err));\r\n    // songsToClassify = loadJSON(toClassify, () => {\r\n\r\n}\r\n\r\nasync function train(xs, ys) {\r\n\r\n    const options = {\r\n        epochs: 50, // number of times it iterates over training data\r\n        validationSplit: 0.1,\r\n        shuffle: true,\r\n        callbacks: {\r\n            onTrainBegin: () => console.log(\"training start\"),\r\n            onTrainEnd: () => console.log(\"training complete\"),\r\n            onEpochEnd: (num, logs) => {\r\n                console.log(`Epoch: ${num}`);\r\n                console.log(logs);\r\n            }\r\n        }\r\n        // shuffle\r\n    };\r\n\r\n    return await model.fit(xs, ys, options);\r\n}\r\n\r\n\r\n\r\nfunction makeInputs(): void {\r\n    let features = [];\r\n    for (let singleSong of data) {\r\n        for (let singleFeature of data[singleSong]) {\r\n            console.log(data[singleSong][singleFeature]);\r\n        }\r\n    }\r\n}\r\n\r\nfunction loadJSON(url: string): Promise<any> {\r\n\r\n    return new Promise((resolve, reject) => {\r\n        let xobj = new XMLHttpRequest();\r\n        xobj.overrideMimeType(\"application/json\");\r\n        xobj.open('GET', url, true); // Replace 'my_data' with the path to your file\r\n        xobj.onreadystatechange = () => {\r\n            if (xobj.readyState == 4 && xobj.status == 200) {\r\n                resolve(xobj.responseText);\r\n            }\r\n        };\r\n        xobj.send(null);\r\n        xobj.onerror = () => reject(xobj.statusText);\r\n    });\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n"]}